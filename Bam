<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>My Mini App</title>
    <!-- 1. –ü–æ–¥–∫–ª—é—á–∞–µ–º –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç Telegram -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            /* –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞ –∏–∑ –∫–ª–∏–µ–Ω—Ç–∞ Telegram –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –¥–∏–∑–∞–π–Ω–∞ */
            --tg-theme-bg-color: var(--tg-theme-bg-color, #ffffff);
            --tg-theme-text-color: var(--tg-theme-text-color, #000000);
            --tg-theme-button-color: var(--tg-theme-button-color, #2481cc);
            --tg-theme-button-text-color: var(--tg-theme-button-text-color, #ffffff);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            padding: 20px;
            margin: 0;
            background-color: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            text-align: center;
        }

        #app {
            max-width: 390px;
            margin: 0 auto;
        }

        #user-info {
            background-color: rgba(128, 128, 128, 0.1);
            padding: 15px;
            border-radius: 12px;
            margin-top: 20px;
            text-align: left;
        }

        button {
            display: block;
            width: 100%;
            padding: 15px;
            border-radius: 12px;
            border: none;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            background-color: var(--tg-theme-button-color);
            color: var(--tg-theme-button-text-color);
        }
    </style>
</head>
<body>
    <div id="app">
        <h1>–ü—Ä–∏–≤–µ—Ç –∏–∑ Mini App! üëã</h1>
        <p>–≠—Ç–æ –æ–∫–Ω–æ ‚Äî –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–∞, –∑–∞–ø—É—â–µ–Ω–Ω–∞—è –ø—Ä—è–º–æ –≤–Ω—É—Ç—Ä–∏ Telegram.</p>
        
        <div id="user-info">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
        
        <button id="close-button">–ó–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</button>
        <button id="main-button">–ü–æ–∫–∞–∑–∞—Ç—å/–°–∫—Ä—ã—Ç—å –≥–ª–∞–≤–Ω—É—é –∫–Ω–æ–ø–∫—É</button>
    </div>

    <script>
        try {
            // 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Web App API
            const tg = window.Telegram.WebApp;
            tg.ready(); // –°–æ–æ–±—â–∞–µ–º Telegram, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≥—Ä—É–∑–∏–ª–æ—Å—å
            tg.expand(); // –†–∞—Å–∫—Ä—ã–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –≤—Å—é –≤—ã—Å–æ—Ç—É

            // 3. –ü–æ–ª—É—á–∞–µ–º –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const userInfoContainer = document.getElementById('user-info');
            if (tg.initDataUnsafe?.user) {
                const user = tg.initDataUnsafe.user;
                userInfoContainer.innerHTML = `
                    <p>üë§ <strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</strong> ${user.first_name} ${user.last_name || ''}</p>
                    <p>üÜî <strong>ID:</strong> ${user.id}</p>
                    <p>üåê <strong>–ù–∏–∫:</strong> @${user.username || '–Ω–µ—Ç'}</p>
                `;
            } else {
                userInfoContainer.innerText = '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑ –∫–ª–∏–µ–Ω—Ç–∞ Telegram.';
            }

            // 4. –£–ø—Ä–∞–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º Telegram
            const closeButton = document.getElementById('close-button');
            closeButton.addEventListener('click', () => {
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–æ–º–∞–Ω–¥—É Telegram –Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏–µ –æ–∫–Ω–∞ Mini App
                tg.close();
            });

            // 5. –†–∞–±–æ—Ç–∞ —Å –≥–ª–∞–≤–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π (MainButton)
            const mainButton = document.getElementById('main-button');
            let mainButtonVisible = false;

            tg.MainButton.setText('–ì–õ–ê–í–ù–ê–Ø –ö–ù–û–ü–ö–ê');
            tg.MainButton.onClick(() => {
                tg.showAlert('–í—ã –Ω–∞–∂–∞–ª–∏ –Ω–∞ –≥–ª–∞–≤–Ω—É—é –∫–Ω–æ–ø–∫—É!');
            });

            mainButton.addEventListener('click', () => {
                if (mainButtonVisible) {
                    tg.MainButton.hide();
                } else {
                    tg.MainButton.show();
                }
                mainButtonVisible = !mainButtonVisible;
            });

        } catch (e) {
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫, –µ—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
            const appDiv = document.getElementById('app');
            appDiv.innerHTML = `<p><strong>–û—à–∏–±–∫–∞:</strong> ${e.message}.<br>–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ—Ç–∫—Ä—ã–ª–∏ —ç—Ç–æ –∫–∞–∫ Mini App –≤ Telegram.</p>`;
        }
    </script>
</body>
</html>
